
    ---
    layout: post  
    title:  利用Excel从文件夹中提取所有文件名  
    date:  2011-02-12 09:36  
    author: Pickle Cai  
    categories: EduBlog  
    keywords: 
    description:   
    tags:	pickle   
    cover:  "/assets/cover.jpeg"  

    ---  
    
文章来源：http://tech.sina.com.cn/c/2003-02-21/17805.html

有时我们想要把一个文件夹中的所有文件名整理到一个文件中，便于管理和查询以及打印，多数是使用“复制”、“粘贴”方法(将文件夹中的文件重命名，在可编辑状态下进行复制，而后在其他文档中粘贴)。这种办法可行，但对于文件夹中有大量的文件的情况，则工作效率低，而且做完后必须核对。利用DOS的重定向命令“〉”加Excel的引用外部数据功能可实现方便快捷的方法(关于   DOS中的重定向“〉”，《中国电脑教育报》2002年第25期A35版中《重定向的妙用》已详细介绍)。假设我们要提取C盘下的Windows目录下的所有文件及文件夹名。第1步在DOS或Windows 98的MS-DOS方式下，输入如下命令：C:＼windows＼dir〉d:＼1.txt(回车)第2步打开一个新的Excel XP电子表格，单击工具栏中的“数据”下拉菜单，选择“导入外部数据→导入数据”命令，打开“导入数据”对话框，在“查找范围”中找到D盘下的1.txt文档，单击“打开”，进入“文本导入向导-3步骤之1”(如图1)。第3步在“原始数据类型”单选框中选“分隔符号”后按“下一步”，进入“文本导入向导-3步骤之2”(如图2)。第4步在“分隔符号”复选框中选“分号、逗号、空格、其他”，并在“其他”后的空格中填“.”，按“下一步”，进入“文本导入向导-3步骤之3”(如图3)。第5步单击“完成”，出现“导入数据”对话框，选择“现有工作表”单选框后按“确定”。到了这里，你应可以看到8列数据，第一列便是所要的“文件名”。但是，DIR命令的显示的中文文件名只显示3～4个汉字，别急，看看第7列(G列)，所有的完整的文件名都在这里！第8列是文件名的后缀，方便于筛选(对于Excel 2000，所不同的是在工具栏中的“数据”下拉菜单下，选择的是“获取外部数据/导入文本文件”命令)。至此，你就可以用Excel来编辑这些文件名了。

另一种方法：



http://www.gwxdn.com/html/system/windows7/2010/0827/11768.html









1，打开一个记事本文档，然后复制下列内容到文档中。 @echo off  dir /s/b *.* > 文件名.txt  exit  2、将上述内容复制到要提取文件名的文件夹，然后将该文件改名为X.bat(X可为任意名称)，然后双击运行，就能完成你的要求了。



						

		    
 中国教育在线·教育人

